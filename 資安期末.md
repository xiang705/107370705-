# 107370705資安-Webgoat範例演練
## 再來挑戰一次，安裝Webgoat！
期中時嘗試許多方法、也參考了十分大量的教學文章來幫助自己順利安裝Webgoat，也下載各式版本來練習，最終卻都還是安裝失敗。　　　
而安裝失敗時，若嘗試連接至http://localhost:8080/WebGoat   則網頁將會顯示：   
![image](https://github.com/xiang705/107370705-/blob/main/%E6%9C%AA%E5%AE%89%E8%A3%9D%E7%95%AB%E9%9D%A2.jpg) 
   
而教學文章中所述，若是成功安裝時，命令提示字元視窗應顯示畫面如下：
![image](https://github.com/xiang705/107370705-/blob/main/%E5%AE%89%E8%A3%9D%E6%88%90%E5%8A%9F.png)   
   
經歷了百般嘗試後，我的安裝、開始畫面依然   
![image](https://github.com/xiang705/107370705-/blob/main/%E5%AE%89%E8%A3%9D%E5%A4%B1%E6%95%97.jpg)   
   
這時我帶著姑且一試的心態再次開啟http://localhost:8080/WebGoat       
卻意外地連接上了畫面，並順利註冊帳號！   
![image](https://github.com/xiang705/107370705-/blob/main/%E8%A8%BB%E5%86%8A%E7%95%AB%E9%9D%A2.png)   
   
也順利地進入了Webgoat的頁面   
![image](https://github.com/xiang705/107370705-/blob/main/%E6%88%90%E5%8A%9F%E9%96%8B%E5%95%9F%E7%B6%B2%E9%A0%81.png)   
   
## 演練一：身分驗證繞過 (Authentication Bypasses)     
>利用網頁中身分認證的設計缺陷，進而達到取得帳號權限目的，而在WebGoat中將這個部分分為3個部分，分別為Authentication Bypasses 、JWT tokens及Password reset。  
>    
>首先是身分驗證繞過的部分，主要分為幾種方式，包含觀察網頁是否有隱藏表單輸入欄位、請求中的參數是否可以被修改或移除、及強行瀏覽不允許存取的頁面等。  
>    
>透過擷取回答安全問題的HTTP請求，發現請求的內容如下，其中有兩個參數分別叫做「securityQuestion0」and「securityQuestion1」。   
>   
>首先，我們先觀察在兩個欄位中填入隨意值後送出，利用ZAP把請求攔截下來，並看看HTTP請求長什麼樣子，而我們也可以發現這些參數的值都是藏在隱藏的表單欄位中的。   
![image](https://github.com/xiang705/107370705-/blob/main/%E7%AC%AC%E4%B8%80%E9%A1%8C%E9%A1%8C%E7%9B%AE.png)   
   
按照教學進行演練的第一步驟：   
![image](https://github.com/xiang705/107370705-/blob/main/%E7%AC%AC%E4%B8%80%E9%A1%8C%E6%AD%A5%E9%A9%9F%E4%B8%80.png)   
![image](https://github.com/xiang705/107370705-/blob/main/%E7%AC%AC%E4%B8%80%E9%A1%8C%E6%AD%A5%E9%A9%9F%E4%BA%8C.png)   
   
>在這一題，如果模仿剛剛提到的Paypal漏洞是不會有結果的，也就是如果直接把secQuestion0跟secQuestion1兩個參數刪掉是不能過關的，在不知道該怎麼辦的狀況下，決定偷偷看一下提示，發現提示中有提到在這一題內並不是要將參數刪掉，而是要對參數進行竄改。   
   
   
教學也提醒了我們，網站中是有提示可以使用的，若實在沒有頭緒便可透過提示來輔助自己演練更加順利。   
![image](https://github.com/xiang705/107370705-/blob/main/%E7%AC%AC%E4%B8%80%E9%A1%8C%E6%AD%A5%E9%A9%9F%E4%B8%89.png)   
而跟著教學修改之後，便可得到相同的成功結果！　　　
![image](https://github.com/xiang705/107370705-/blob/main/%E7%AC%AC%E4%B8%80%E9%A1%8C%E6%88%90%E5%8A%9F.png)   
此時可以任意修改密碼，即為演練成功。   
  
  
  
  
  
## 演練二：請求偽造 (Request Forgeries)   
   
>所謂的跨站請求偽造，也被稱為 one-click attack 或者 session riding，通常縮寫為 CSRF（常被念做sea-surf） 或者 XSRF， 這種攻擊會挾制使用者目前正在瀏覽的網頁，並執行並非使用者預期會執行的動作。   
>可能有人會把這種攻擊方式跟跨網站指令碼 (XSS)做比較，簡單來說，XSS攻擊利用的是使用者對網站的信任，也就是使用者會相信並執行網站顯示的任何內容；CSRF 利用的則是網站對使用者網頁瀏覽器的信任，瀏覽器會相信請求是來自合法的使用者並開啟網頁。   
   
>CSRF通常具有下列特徵：
   
> 1.包含依賴使用者身分認證的網頁   
> 2.利用網頁對於該身分的信任   
> 3.欺騙使用者的瀏覽器，並將HTTP請求送到目標網站去   
> 4.包含有副作用 (side-effects)的HTTP請求   
>  
>舉個例子，假設一個網頁他會利用HTTP Header的cookie欄位來判斷使用者是不是在登入的狀態，才會允許執行某些功能，但因為他只驗證cookie，所以有可能這個HTTP請求並不是使用者本人發出的，但卻還是通過驗證，並執行了並非使用者自願執行的功能，這樣就是有CSRF風險存在。   
   
>如果今天小明登入了一個網路銀行，這個網路銀行的轉帳功能是利用這個網址達成的：http://bank.com/transfer?account_number_from=123456789&account_number_to=987654321&amount=100000 。   
>在小明仍然還處於登入狀態的時候，如果他同時開啟另一個分頁，並讀取一個被植入一串惡意程式碼（如下）的網頁，這段惡意程式碼表面上是一個超連結，且顯示的文字是邀請小明點選去看他的圖片，但若是小明真的點選了，他實際上卻是發出一個把小明帳戶金額轉帳到其他帳戶的HTTP請求。   

```<a href="http://bank.com/transfer?account_number_from=123456789&account_number_to=987654321&amount=100000">正妹照無限量供應！</a>```   
更進階的做法是，攻擊者可以把惡意程式碼藏在img標籤裡（如下），這樣小明連超連結都不用點，只要一打開這個網頁就直接執行惡意代碼了。   
```<img href="http://bank.com/transfer?account_number_from=123456789&account_number_to=987654321&amount=100000">```   
   
   
## 心得   
   
其實Webgoat的使用對於我來說還是十分吃力，其一是安裝的方法非常費力，並且我的情況又很特殊（全都失敗，又成功得很突然），其二則是由於網站皆以英文居多，即使使用翻譯軟體也詞不達意，造成理解上又多了一層障礙。   
   
不過跟著如此完整的教學來演練，並且作者也在文章中清楚解釋該項演練的重點及範例，因此在理解上有很大幫助。   
   
在演練一中所學到的身分驗證繞過令我聯想到的是從小到大用的許多社群、通訊軟體、網路遊戲都有設定管理員權限的功能，許多要件皆只有管理員身分的使用者可以進行操作，而透過此身分驗證的漏洞，便可以使有心人肆意對該軟體進行惡意破壞等。   
   
以往最常見的就是遊戲伺服器的惡作劇破壞，因此其實這是我們從兒時就會接觸到的資安問題，也與我們息息相關的。   
   
   
演練二的內容更是與現在的我們不可分割，網路日漸蓬勃發展的時代，由於現代人也忙碌，因此網路銀行被廣為使用。   
   
在教學所提的例子中，若惡意的程式碼可以隨意通過認證，而危害到使用者的權益，與金錢扯上關係的詐騙行為尤為棘手，事後請求相關單位協助也十分勞師動眾，且最擔心地便是無法妥善解決。  
   
   
隨著時代演變、科技的發展，資安問題十分重要，絕對不容忽視，現代網路與生活中大小事都綁在一起、難以分割，經常牽一髮動全身，因此透過這個課堂（雖然難度偏高，理解也不多）更加懂得如何保護自己，往後在網路世界也能更安全地使用。
